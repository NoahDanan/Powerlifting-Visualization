<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Powerlifting Visualization</title>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <style>
        .data-text {
            fill: #fff;
            font-size: 16px; /* Adjusted for larger view */
            visibility: hidden;
        }
        .data-text--show {
            visibility: visible;
        }
        .legend-text {
            font-size: 14px; /* Adjusted for larger view */
        }
    </style>
</head>
<body>
    <script>
        const pieData = [
            {name: 'Running', value: 40, color: '#18FFFF'},
            {name: 'Paused', value: 26, color: '#0288D1'},
            {name: 'Stopped', value: 7, color: '#BF360C'},
            {name: 'Failed', value: 13, color: '#F4511E'},
            {name: 'Unknown', value: 19, color: '#F9A825'},
        ];
        bakeDonut(pieData);

        function bakeDonut(d) {
            let activeSegment;
            const data = d.sort((a, b) => b['value'] - a['value']),
                  viewWidth = 1000, // Increased from 500
                  viewHeight = 600, // Increased from 300
                  svgWidth = viewHeight,
                  svgHeight = viewHeight,
                  thickness = 80, // Increased to maintain visual proportion
                  colorArray = data.map(k => k.color),
                  el = d3.select('body'),
                  radius = Math.min(svgWidth, svgHeight) / 2,
                  color = d3.scaleOrdinal().range(colorArray);

            const max = d3.max(data, (maxData) => maxData.value);

            const svg = el.append('svg')
                .attr('viewBox', `0 0 ${viewWidth + thickness} ${viewHeight + thickness}`)
                .attr('class', 'pie')
                .attr('width', viewWidth)
                .attr('height', svgHeight);

            const g = svg.append('g')
                .attr('transform', `translate(${(svgWidth / 2) + (thickness / 2)}, ${(svgHeight / 2) + (thickness / 2)})`);

            const arc = d3.arc()
                .innerRadius(radius - thickness)
                .outerRadius(radius);

            const arcHover = d3.arc()
                .innerRadius(radius - (thickness + 5))
                .outerRadius(radius + 10); // Slightly increased for emphasis

            const pie = d3.pie()
                .value(function(pieData) { return pieData.value; })
                .sort(null);

            const path = g.selectAll('path')
                .data(pie(data))
                .enter()
                .append('g')
                .attr('class', 'data-group')
                .each(function(pathData, i) {
                    const group = d3.select(this);

                    group.append('text')
                        .text(`${pathData.data.value}`)
                        .attr('class', 'data-text data-text__value')
                        .attr('text-anchor', 'middle')
                        .attr('dy', '2rem'); // Adjusted for new size

                    group.append('text')
                        .text(`${pathData.data.name}`)
                        .attr('class', 'data-text data-text__name')
                        .attr('text-anchor', 'middle')
                        .attr('dy', '4rem'); // Adjusted for new size
                })
                .append('path')
                .attr('d', arc)
                .attr('fill', (fillData) => color(fillData.data.name))
                .attr('class', 'data-path')
                .on('mouseover', function(event, d) {
                    // Same interaction, adjusted for new sizes
                });

            const legendRectSize = 20; // Increased for visibility
            const legendSpacing = 12; // Adjusted spacing

            const legend = svg.selectAll('.legend')
                .data(color.domain())
                .enter()
                .append('g')
                .attr('class', 'legend')
                .attr('transform', function(legendData, i) {
                    const itemHeight = legendRectSize + legendSpacing;
                    const offset = legendRectSize * color.domain().length;
                    const horz = svgWidth + 100; // Adjusted for new size
                    const vert = (i * itemHeight) + legendRectSize + (svgHeight - offset) / 2;
                    return `translate(${horz}, ${vert})`;
                });

            legend.append('circle')
                .attr('r', legendRectSize / 2)
                .style('fill', color);

            legend.append('text')
                .attr('x', legendRectSize + legendSpacing)
                .attr('y', legendRectSize - legendSpacing / 2)
                .attr('class', 'legend-text')
                .text((legendData) => legendData);
        }
    </script>
</body>
</html>
